<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>Hello MUI</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<link rel="stylesheet" href="../../css/mui.min.css">
		<link rel="stylesheet" type="text/css" href="../../sass/public.css" />
		<link rel="stylesheet" type="text/css" href="../../sass/toucun.css" />
		<script src="../../js/iconfont.js" type="text/javascript"></script>
		<style>
		html,
			body {
				background-color: #efeff4;
			}
			
			#scroll1 {
				overflow: scroll;
			}
			
			.mui-control-content {
				height: 100%;
			}	
		</style>
	</head>

	<body>
		<!--<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">选项卡切换+下拉刷新</h1>
		</header>-->

		<div class="mui-content" id="overAll">

			<div id="slider" class="mui-fullscreen">
				<div id="sliderSegmentedControl" class="mui-scroll-wrapper mui-segmented-control mui-segmented-control-inverted">
					<div class="mui-scroll">
						<a class="mui-control-item mui-active" href="#item1">
							总体
						</a>
						<a class="mui-control-item" href="#item2">
							高客
						</a>
						<a class="mui-control-item" href="#item3">
							直播
						</a>

					</div>
				</div>
				<div id="sliderProgressBar" class="mui-slider-progress-bar mui-col-xs-4"></div>

				<div style="position: absolute;top: 40px;bottom: 0;width: 100%;">
					<div id="item1" class="mui-control-content mui-active">
						<div id="scroll1" class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<div class="toucun-filter row toucun-padding">
									<div>filter</div>
									<div id="filter">
										<span id="" class="active">交易所</span>
										<span class="active-no">品种</span>
										<span class="active-no">高客小组</span>
										<span class="active-no">直播室</span>
									</div>
								</div>
								<div class="line"></div>
								<div class="toucun-abs toucun-padding">
									<div class="abs-top">
										<div style="font-weight: bolder;">净头寸：</div>
										<div class="abs-conter row">
											<div class="abs-conter-left">
												<p class="red txtcenter" style="font-size: 30px;">50</p>
												<p class="txtcenter">亿万（头寸单位）</p>
											</div>
											<div class="abs-conter-right">
												<p class="txtcenter"><span class="red ">101</span><span>(多)</span></p>
												<p class="txtcenter"><span class="blue">51</span><span>(空)</span></p>
											</div>
										</div>
									</div>
									<div class="abs-bottom">
										<div id="abs-chart" class="abs-chart"></div>
									</div>
								</div>
								<div class="line"></div>

								<div class="toucun-chicang toucun-padding">
									<div id="chicang-chart" class="chicang-chart"></div>
								</div>
								<div class="line"></div>
								<!--<div class="toucun-cangwei toucun-padding"></div>-->
								<div class="toucun-chicang toucun-padding">
									<div id="cangwei-chart" class="chicang-chart"></div>
								</div>
							</div>
						</div>
					</div>
					<div id="item2" class="mui-control-content">
						<div class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<ul class="mui-table-view">
									<li class="mui-table-view-cell">
										第2个选项卡子项-1
									</li>
									<li class="mui-table-view-cell">
										第2个选项卡子项-2
									</li>
								</ul>
							</div>
						</div>
					</div>
					<div id="item3" class="mui-control-content">
						<div class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<!--liveBroadcast  =>   lbdc   直播-->
								<div class="lbdc-filter row toucun-padding">
									<div>交易所</div>
									<div id="lbdcFilter">
										<span id="" class="active">合计</span>
										<span class="active-no">津贵</span>
										<span class="active-no">粤贵</span>
									</div>
								</div>
								<ul class="mui-table-view" id="lbdcTable">
									<table id="tableSort">
										<!--<thead class="mui-table-view-cell row lbdc-thead">-->
										<thead>
											<tr>
												<th data-type="num">直播室</th>
												<th data-type="num">多头金额
													<svg class="icon" aria-hidden="true">
														<use xlink:href="#icon-paixu-close-copy"></use>
													</svg>
												</th>
												<th data-type="num">空头金额
													<svg class="icon" aria-hidden="true">
														<use xlink:href="#icon-paixu-close-copy"></use>
													</svg>
												</th>
												<th data-type="num">净头寸
													<svg class="icon" aria-hidden="true">
														<use xlink:href="#icon-paixu-close-copy"></use>
													</svg>
												</th>
												<th data-type="num">多头人数
													<svg class="icon" aria-hidden="true">
														<use xlink:href="#icon-paixu-close-copy"></use>
													</svg>
												</th>
												<th data-type="num">空头人数
													<svg class="icon" aria-hidden="true">
														<use xlink:href="#icon-paixu-close-copy"></use>
													</svg>
												</th>
												<th data-type="num">持仓总人数
													<svg class="icon" aria-hidden="true">
														<use xlink:href="#icon-paixu-close-copy"></use>
													</svg>
												</th>
												<th data-type="num">多头盈亏
													<svg class="icon" aria-hidden="true">
														<use xlink:href="#icon-paixu-close-copy"></use>
													</svg>
												</th>
												<th data-type="num">空头盈亏
													<svg class="icon" aria-hidden="true">
														<use xlink:href="#icon-paixu-close-copy"></use>
													</svg>
												</th>
											</tr>
										</thead>
										<tbody id="lbdcTbody"></tbody>
									</table>

								</ul>
							</div>
						</div>
					</div>

				</div>
			</div>
		</div>
		<script src="../../js/mui.min.js"></script>
		<script src="../../outerControl/echarts.js"></script>
		<script src="../../js/mui.pullToRefresh.js"></script>
		<script src="../../js/publicFunction.js" type="text/javascript"></script>
		<script src="../../js/mui.pullToRefresh.material.js" type="text/javascript">
		</script>
		<!--<script src="../../js/mui.pullToRefresh.js"></script>-->
		<script>
			mui.init();
			//切换选项卡
			switchTab(document.querySelectorAll("#filter span")); //总体  切换四个tab
			switchTab(document.querySelectorAll("#lbdcFilter span")); //直播  切换三个tab
			//滑动模块不影响页面滑动
			//			divScroll(document.getElementById("chicang-chart"));
			//			divScroll(document.getElementById("lbdcTable"));
           (function($) {
                //阻尼系数
                var deceleration = mui.os.ios?0.003:0.0009;
                $('.mui-scroll-wrapper').scroll({
                    bounce: false,
                    indicators: true, //是否显示滚动条
                    deceleration:deceleration
                });
                $.ready(function() {
                    //循环初始化所有下拉刷新，上拉加载。
                    $.each(document.querySelectorAll('.mui-control-content .mui-scroll'), function(index, pullRefreshEl) {
                        $(pullRefreshEl).pullToRefresh({
                            down: {
                                callback: function() {
                                    var self = this;
                                    setTimeout(function() {
                                        self.endPullDownToRefresh();
                                    }, 10000);
                                }
                            }
                        });
                    });
                });
           

			//持仓趋势折线图
			var chicangChart = echarts.init(document.getElementById("chicang-chart"));
			//净头寸饼状图
			var absChart = echarts.init(document.getElementById("abs-chart"));
			//仓位趋势折线图
			var cangweiChart = echarts.init(document.getElementById("cangwei-chart"));
			//多空盈亏折线图
			//		var duokongChart=echarts.init(document.getElementById("dongkong-chart"));
			//			var chicang = ;
			//		var timeH,timeM,xArr;
			//		var newDate=new Date();
			//		timeH=newDate.getHours();
			//		timeM=newDate.getMinutes();
			//		if(timeH<10){
			//			timeH="0"+timeH;
			//		}
			//		if(timeM<10){
			//			timeM="0"+timeM;
			//		}
			//		var timeX=timeH+":"+timeM;
			//		xArr.push(timeX);
			var number1 = [];
			var number2 = [];
			//var myTime=setInterval(function(){
			//	number1.push("80");
			//	number2.push("100");
			//		chicangChart.setOption(option);
			//},300)            
			var array3 = [];
			var aaaa = ['做多', '做空'];
			var array1 = [120, 132, 101, 134, 90, 230, 210, 120, 132, 101, 134, 90, 230, 210, 120, 132, 101, 134, 90, 230, 210, 120, 132, 101, 134, 90, 230, 210, 120, 132, 101, 134, 90, 230, 210, 120, 132, 101, 134, 90, 230, 210];
			var array2 = [220, 182, 191, 234, 290, 330, 310, 150, 232, 201, 154, 190, 330, 410, 150, 232, 201, 154, 190, 330, 410, 220, 182, 191, 234, 290, 330, 310, 150, 232, 201, 154, 190, 330, 410, 150, 232, 201, 154, 190, 330, 410];

			//未知，在这里设置这个array3后。不会画折线
			array3 = sumArray(array1, array2);
//			console.log(array3);
			option = {
				title: {
					text: '持仓趋势'
				},
				tooltip: {
					trigger: 'axis'
				},
				legend: {
					data: aaaa,
					top: 20,
					left: 250
				},
				grid: {
					left: '1%',
					right: '4%',
					bottom: '3%',
					containLabel: true
				},
				toolbox: {
					feature: {
						//					          saveAsImage: {}
					}
				},
				xAxis: {
					type: 'category',
					boundaryGap: false,
					data: ['00:00', '00:01', '周三', '周四', '周五', '周六', '周日', '周一', '周二', '周三', '周四', '周五', '周六', '周日', '周一', '周二', '周三', '周四', '周五', '周六', '周日', '周一', '周二', '周三', '周四', '周五', '周六', '周日', '周一', '周二', '周三', '周四', '周五', '周六', '周日', '周一', '周二', '周三', '周四', '周五', '周六', '周日']
				},
				yAxis: {
					type: 'value'
				},
				series: [{
						name: '做多',
						type: 'line',
						itemStyle: {

							normal: {
								color: 'white', //折线点颜色
								lineStyle: {
									color: 'black' //折线颜色
								}
							}
						},
						//					stack: '总量',
						data: [120, 132, 101, 134, 90, 230, 210, 120, 132, 101, 134, 90, 230, 210, 120, 132, 101, 134, 90, 230, 210, 120, 132, 101, 134, 90, 230, 210, 120, 132, 101, 134, 90, 230, 210, 120, 132, 101, 134, 90, 230, 210]
						//					data:number1
					},
					{
						name: '做空',
						type: 'line',
						itemStyle: {
							normal: {
								lineStyle: {
									color: 'blue'
								}
							}
						},
						//					stack: '总量',
						data: [220, 182, 191, 234, 290, 330, 310, 150, 232, 201, 154, 190, 330, 410, 150, 232, 201, 154, 190, 330, 410, 220, 182, 191, 234, 290, 330, 310, 150, 232, 201, 154, 190, 330, 410, 150, 232, 201, 154, 190, 330, 410]
						//					data:number2
					},
					{
						name: '总数',
						type: 'line',
						data: sumArray(array1, array2)
						//					data:array3
					},
				]
			};
			option2 = {
				//  tooltip: {
				//      trigger: 'item',
				//      formatter: "{a} <br/>{b}: {c} ({d}%)"
				//  },
				grid: {

				},
				legend: { //饼图的解释
					//      orient: 'vertical',    //饼图下面小菜单的排列方式   
					x: 'center',
					y: "bottom",
					data: ['多头', '空头']
				},
				series: [{
					name: '访问来源',
					type: 'pie',
					radius: ['50%', '75%'],
					avoidLabelOverlap: false,
					label: {
						normal: {
							show: true,
							formatter: "持仓金额",
							position: 'center',
							textStyle: {
								fontSize: '12',
								fontWeight: 'bold',
								color: "black"
							}
						},
						emphasis: {
							show: false,
							//                  formatter:"持仓金额",
							textStyle: {
								fontSize: '12',
								fontWeight: 'bold',
								color: "black"
							}
						}
					},
					labelLine: {
						normal: {
							show: false
						}
					},
					data: [{
							value: 335,
							name: '多头'
						},
						{
							value: 310,
							name: '空头'
						}
					]
				}]
			};
			//将数据插入echarts canvas绘制成图表
			chicangChart.setOption(option);
			absChart.setOption(option2);
			cangweiChart.setOption(option2);
			 })(mui);
		</script>
		<script>
			//获取直播表格总揽数据，动态生成总揽表格
			var table = [{
				a: "名师指路",
				b: 2,
				c: 13,
				d: 45,
				e: 5,
				f: 66,
				g: 77,
				h: 85,
				i: 119
			}, {
				a: "股银直播",
				b: 22,
				c: 3,
				d: 43,
				e: 54,
				f: 655,
				g: 76,
				h: 84,
				i: 93
			}, {
				a: "股海直播",
				b: 2,
				c: 332,
				d: 43,
				e: 5,
				f: 6,
				g: 73,
				h: 8,
				i: 93
			}, {
				a: "博股直播",
				b: 2,
				c: 3,
				d: 43,
				e: 53,
				f: 63,
				g: 337
			}, {
				a: "会银直播",
				b: 2,
				c: 33,
				d: 43,
				e: 5333,
				f: 63,
				g: 7
			}];
			//表格生成插入
			mui.each(table, function(rowNumber, row) {
				var tBodyRow = document.createElement("tr");
				tBodyRow.id = "detail" + rowNumber;
				//				tBodyRow.className = "mui-table-view-cell row lbdc-tbody";
				mui.each(row, function(colNumber, col) {
					var tBodySpan = document.createElement("td");
					tBodySpan.innerText = col;
					tBodyRow.appendChild(tBodySpan);
				})
				document.getElementById("lbdcTbody").appendChild(tBodyRow);
			})
		</script>
		<script type="text/javascript">
			//选项卡切换 下标显示
			var buttonTopArr = document.getElementById("sliderSegmentedControl").getElementsByClassName("mui-scroll")[0].getElementsByTagName("a");
			for(var i = 0; i < buttonTopArr.length; i++) {
				buttonTopArr[i].index = i;
				buttonTopArr[i].addEventListener("tap", function() {
					document.getElementById("sliderProgressBar").style.left = (1 / buttonTopArr.length) * (this.index) * 100 + "%";
				})
			}
			//表格列表排序
			var tbody = document.querySelector('#tableSort').tBodies[0];
			var th = document.querySelector('#tableSort').tHead.rows[0].cells;
			var td = tbody.rows;
			for(var i = 1; i < th.length; i++) {
				th[i].flag = 1;
				//				th[i].onclick = function() {};
				th[i].addEventListener("tap", function() {

					for(var i = 1; i < th.length; i++) {
						th[i].getElementsByTagName("use")[0].href.baseVal = "#icon-paixu";
					}
					sort(this.getAttribute('data-type'), this.flag, this.cellIndex);
					this.flag = -this.flag;
//					console.log(this.getElementsByTagName("use")[0].href);
					if(this.flag == 1) {
						this.getElementsByTagName("use")[0].href.baseVal = "#icon-paixu-down";
					} else {
						this.getElementsByTagName("use")[0].href.baseVal = "#icon-paixu-up";
					}
				})

			};

			function sort(str, flag, n) {
				var arr = []; //存放DOM
				for(var i = 0; i < td.length; i++) {
					arr.push(td[i]);
				};
				//排序
				arr.sort(function(a, b) {
					return method(str, a.cells[n].innerHTML, b.cells[n].innerHTML) * flag;
				});
				//添加
				for(var i = 0; i < arr.length; i++) {
					tbody.appendChild(arr[i]);
				};
			};
			//排序方法
			function method(str, a, b) {
				switch(str) {
					case 'num': //数字排序
						return a - b;
						break;
					case 'string': //字符串排序
						return a.localeCompare(b);
						break;
					default: //日期排序，IE8下'2012-12-12'这种格式无法设置时间，替换成'/'
						return new Date(a.split('-').join('/')).getTime() - new Date(b.split('-').join('/')).getTime();
				};
			};

			var listTrs = document.querySelectorAll("#lbdcTbody tr");
			for(var i = 0; i < listTrs.length; i++) {
				listTrs[i].addEventListener("tap", function() {
					alert(this.id);
					mui.openWindow({
						url: '../toucun/toucun-liveBro-detail.html',
						show: {
							autoShow: false
						}
					})
				})
			}
		</script>
	</body>

</html>